{% extends "ue_base.html" %}

{% block page_content %}
<div class="containerxx">
    <h3 class="yellow_text"><i>All Favorite Movies</i></h3>
    <table id="#main" class="table table-primary table-striped table-hovers">
        <thead>
            <tr>
                <th scope="col"></th>
                <th scope="col">Movie Title</th>
                <th scope="col">Year</th>

                    {# <th scope="col">Added by</th> #}

                <th scope="col"># likes </th>
                <th scope="col">like/un-like </th>
            </tr>
        </thead>
        <tbody>    
    
        {% for movie in movies %}
            <tr>
                <td>{{movie.id}}</td>
                {% comment %} <td><a href="/user_experience/movie_info_discussion_page/{{movie.id}}">{{movie.title}}</a></td> {% endcomment %}
                <td><a href="/user_experience/movie_discussion/{{movie.id}}">{{movie.title}}</a></td>
                <td>{{movie.year}}</td>
                <td>{{movie.liked_by.count}}</td>
            {% if movie not in user.liked_by.all %}    
            <td><a class=".like" href="/user_experience/like/{{movie.id}}">Like!</a></td>   {# like and unlike can use the same function #}
                
            {% else %}
                <td><a class=".like" href="/user_experience/like/{{movie.id}}">Unlike!</a></td>   {# like and unlike can use the same function #}
            {% endif %}
            </tr>
        {% endfor %}
        
        </tbody>
    </table>
</div>
{% endblock page_content %}

{% block script %}
<script>    
    $('.like').submit(function(e){
        e.preventDefault();        
        console.log($(this).serialize())
        $.ajax({
    		url: '/user_experience/like/<int:movie_id>',   // {{movie.id}}??                      
    		method: 'post',                         
    		data: $(this).serialize(),              
    		success: function(serverResponse){     
                $('#main').html(serverResponse)    
	        }
        })

        // I think we need this for a form, not for a-tag:   $(this).trigger('reset') 

    });
</script>
{% endblock script %}
